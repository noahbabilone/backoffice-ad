{% extends "ADBundle::layout.html.twig" %}


{% block title %}
    Dashboard - {{ parent() }}
{% endblock %}

{% block ad_body %}

    <div id="wrapper">
        <!-- Navigation -->

        <div id="page-wrapper">
            <div class="row">
                <div class="col-lg-12">
                    <h3 class="page-header">Dashboard</h3>
                </div>
                <!-- /.col-lg-12 -->
            </div>
            <div class="row">
                <div class="col-lg-12">
                    <div class="alert alert-success hide response-ajax">
                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span
                                    aria-hidden="true">&times;</span></button>
                        <span class="text-response-ajax"></span>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <i class="fa fa-users fa-fw"></i> Liste Utlisateurs
                            <div class="pull-right">
                                {#<a href="{{ path('add_user') }}" class="btn btn-success btn-xs"><i#}
                                {#class="fa fa-user fa-fw"></i>Ajouter un utilisateur</a>#}


                                <div class="btn-group">
                                    <button type="button" class="btn btn-default btn-xs dropdown-toggle"
                                            data-toggle="dropdown">
                                        Afficher
                                        <span class="caret"></span>
                                    </button>
                                    <ul class="dropdown-menu pull-right" role="menu">
                                        <li><a href="{{ path('list_users') }}">Tout</a></li>
                                        <li><a href="{{ path('users_by_ou',{'ou': 'Issy-Les-Moulineaux'}) }}">Issy Les
                                                Moulineaux</a></li>
                                        <li><a href="{{ path('users_by_ou',{'ou': 'Luxembourg'}) }}">Luxembourg</a></li>
                                        <li><a href="{{ path('users_by_ou',{'ou': 'Saint-mande'}) }}">Saint Mande</a>
                                        </li>
                                        <li class="divider"></li>
                                        <li><a href="{{ path('users_by_ou',{'ou': 'Compteutilisateur'}) }}">compte
                                                utilsiateur</a>
                                        </li>
                                    </ul>
                                </div>


                            </div>

                        </div>
                        <!-- /.panel-heading -->
                        {#{{ dump(users) }}#}
                        <div class="panel-body">
                            <div class="table-responsive">
                                <table class="table table-striped table-hover">
                                    <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Login</th>
                                        <th>Nom</th>
                                        <th>Email</th>
                                        <th>actions</th>
                                    </tr>
                                    </thead>
                                    <tbody>

                                    {#{% for key, user in users %}#}
                                    {% for key, user in users %}
                                        {% if  key != "count" or key =="0" %}
                                            <tr id="line-{{ key }}">
                                                <td>{{ key }}</td>
                                                <td>{{ ad_active_directory.getData(user,"samaccountname") }}</td>
                                                <td>{{ ad_active_directory.getData(user,"displayname") }}</td>
                                                <td>{{ ad_active_directory.getData(user,"mail") }}</td>
                                                <td>
                                                    {% set login=ad_active_directory.getData(user,"userprincipalname") %}
                                                    <a href="{{ path('get_user',{'login':login }) }}"
                                                       class="btn btn-xs btn-info"><i class="fa fa-user fa-fw"></i></a>
                                                    <a href="{{ path('edit_user',{'person':ad_active_directory.base64Encode(login) }) }}"
                                                       class="btn btn-xs btn-primary"><i class="fa fa-edit fa-fw"></i></a>
                                                    <a href="{{ path('remove_user',{'person':ad_active_directory.getData(user,"cn") }) }}"
                                                       class="btn btn-xs btn-danger btn-remove-user"
                                                       id="{{ ad_active_directory.getData(user,"cn") }}"
                                                       data-tree="{{ ad_active_directory.getData(user,"distinguishedname") }}"
                                                       data-line="line-{{ key }}"><i class="fa fa-remove fa-fw"></i></a>
                                                </td>
                                            </tr>
                                        {% endif %}

                                    {% endfor %}
                                    </tbody>
                                </table>

                                {#{{ dump(users) }}#}

                            </div>

                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                </div>
            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->

    </div>
    <!-- /#wrapper -->

    <!-- Modal -->
    <div class="modal fade" tabindex="-1" id="myModal" role="dialog">
        <div class="modal-dialog" role="document">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title">Suppression de l'utilisateur (<span id="username"></span>)</h4>
                </div>
                <div class="modal-body">
                    <p>Vous voulez vraiment supprimer cet utilisateur !!</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger ok-delete-user" data-dismiss="modal">Oui</button>
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Non</button>
                </div>
            </div>

        </div>
    </div>
{% endblock %}


